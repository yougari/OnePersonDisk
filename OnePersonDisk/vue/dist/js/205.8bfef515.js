"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[205],{5205:function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{display:"flex",color:"#666"}},[t("div",{staticStyle:{width:"200px","text-align":"center","border-right":"1px solid #ddd","min-height":"calc(100vh - 86px)"}},[t("div",{staticStyle:{padding:"10px 0"}},e._l(e.categoryList,(function(s){return t("div",{key:s.text,staticClass:"category",class:{"category-active":e.category===s.category},staticStyle:{padding:"10px 0"},on:{click:function(t){return e.loadFiles(s.category)}}},[s.icon?t("i",{class:s.icon,staticStyle:{"margin-right":"5px"}}):e._e(),t("span",[e._v(e._s(s.text))])])})),0),t("div",{staticStyle:{"border-top":"1px solid #ddd","text-align":"center","padding-top":"10px"}},[t("div",{staticClass:"category",class:{"category-active":"share"===e.category},staticStyle:{padding:"10px 0",display:"flex","justify-content":"center"},on:{click:function(t){return e.loadFiles("share")}}},[e._m(0)]),t("div",{staticClass:"category",class:{"category-active":"trash"===e.category},staticStyle:{padding:"10px 0",display:"flex","justify-content":"center"},on:{click:function(t){return e.loadFiles("trash")}}},[e._m(1)])])]),t("div",{staticStyle:{flex:"1"}},["trash"===e.category?t("Trash",{attrs:{"type-list":e.typeList}}):e._e(),"share"===e.category?t("Share",{attrs:{"type-list":e.typeList}}):t("Main",{attrs:{"type-list":e.typeList}})],1)])])},o=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"75px","text-align":"left"}},[t("i",{staticClass:"el-icon-share",staticStyle:{"margin-right":"5px"}}),t("span",[e._v("我的分享")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"75px","text-align":"left"}},[t("i",{staticClass:"el-icon-delete",staticStyle:{"margin-right":"5px"}}),t("span",[e._v("回收站")])])}],a=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{padding:"15px","border-bottom":"1px solid #ddd"}},[t("el-upload",{staticStyle:{display:"inline-block","margin-right":"10px"},attrs:{action:e.uploadUrl,headers:{token:e.user.token},"show-file-list":!1,"on-success":e.handleFileSuccess}},[t("el-button",{attrs:{type:"primary"}},[e._v("上传文件")])],1),"all"===e.category?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.addFolder}},[e._v("新建文件夹")]):e._e(),t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.delBatch}},[e._v("批量删除")])],1),t("div",{staticStyle:{padding:"15px"}},[t("a",{staticStyle:{color:"#666"},attrs:{href:"/front/home?category="+e.category}},[e._v("全部文件 "),e.folders.length?t("i",{staticClass:"el-icon-arrow-right"}):e._e()]),e._l(e.folders,(function(s,i){return t("a",{key:s.id,staticStyle:{color:"#666"},attrs:{href:"/front/home?category="+e.category+"&folderId="+s.id}},[e._v(" "+e._s(s.name)+" "),i!==e.folders.length-1?t("i",{staticClass:"el-icon-arrow-right"}):e._e()])}))],2),t("div",[t("el-table",{attrs:{size:"medium",stripe:"",data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.unSave?t("div",[t("i",{class:e.typeList.find((e=>e.text===s.row.type))?.icon||"el-icon-file",staticStyle:{color:"#409EFF"}}),t("el-input",{staticStyle:{width:"300px",margin:"0 5px"},attrs:{size:"mini"},model:{value:s.row.name,callback:function(t){e.$set(s.row,"name",t)},expression:"scope.row.name"}}),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.save(s.row)}}},[e._v("确定")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.cancel(s.row)}}},[e._v("取消")])],1):t("div",{staticStyle:{display:"flex",cursor:"pointer"},on:{click:function(t){return e.openFile(s.row)},mouseenter:function(t){return e.mouseEnter(s.row)},mouseleave:function(t){return e.mouseLeave(s.row)}}},[t("div",{staticStyle:{flex:"1"}},[t("i",{class:e.typeList.find((e=>e.text===s.row.type))?.icon||"el-icon-file",staticStyle:{color:"#409EFF"}}),s.row.unSave?e._e():t("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(s.row.name))])]),s.row.optShow?t("div",{staticStyle:{color:"#409EFF","font-size":"14px"}},[t("el-tooltip",{attrs:{content:"分享",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-share",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.share(s.row)}}})]),"否"===s.row.folder?t("el-tooltip",{attrs:{content:"下载",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-download",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.download(s.row.file)}}})]):e._e(),t("el-tooltip",{attrs:{content:"删除",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-delete",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.del(s.row.id)}}})]),t("el-tooltip",{attrs:{content:"重命名",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-rename",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.rename(s.row)}}})]),t("el-tooltip",{attrs:{content:"复制",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-document-copy",staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.copy(s.row)}}})])],1):e._e()])]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:"修改时间",width:"300"}}),t("el-table-column",{attrs:{prop:"size",label:"文件大小（KB）",width:"300"}})],1)],1),t("el-dialog",{attrs:{title:"分享",visible:e.shareVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.shareVisible=t}}},[t("el-form",{staticStyle:{"padding-right":"50px"},attrs:{"label-width":"100px",model:e.form}},[t("el-form-item",{attrs:{label:"分享天数"}},[t("el-radio-group",{model:{value:e.form.days,callback:function(t){e.$set(e.form,"days",t)},expression:"form.days"}},[t("el-radio",{attrs:{label:3}},[e._v("3天")]),t("el-radio",{attrs:{label:7}},[e._v("7天")]),t("el-radio",{attrs:{label:30}},[e._v("30天")])],1)],1),e.shareLink?t("el-form-item",{attrs:{label:"分享链接"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input",{staticStyle:{flex:"1"},model:{value:e.shareLink,callback:function(t){e.shareLink=t},expression:"shareLink"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{cilck:function(t){return e.copyLink(e.shareLink)}}},[e._v("复制")])],1)]):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.shareVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveShare()}}},[e._v("确 定")])],1)],1)],1)},l=[],r=(s(541),{name:"Main",props:{typeList:null},data(){return{category:this.$route.query.category,folderId:this.$route.query.folderId,tableData:[],user:JSON.parse(localStorage.getItem("xm-user")||"{}"),uploadUrl:"",ids:[],folders:[],shareVisible:!1,form:{},shareLink:""}},created(){this.load(),this.uploadUrl=this.$baseUrl+"/diskFiles/add?folder=否",this.folderId&&(this.uploadUrl+="&folderId="+this.folderId)},methods:{saveShare(){this.shareLink?this.shareVisible=!1:this.$request.post("/diskFiles/share/",this.form).then((e=>{if("200"===e.code){this.$message.success("操作成功");let t=e.data,s=location.href.substring(location.href.indexOf("/front"));this.shareLink=s+"/front/openShare?code="+t.code+"&shareId="+t.id}else this.$message.error(e.msg)}))},share(e){this.form=JSON.parse(JSON.stringify(e)),this.form.days=3,this.shareLink="",this.shareVisible=!0},copy(e){this.$request.post("/diskFiles/copy/"+e.id).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))},openFile(e){"是"===e.folder?location.href="/front/home?category="+this.category+"&folderId="+e.id:window.open(this.$baseUrl+"/diskFiles/preview/"+e.fileId)},download(e){window.open(e)},mouseEnter(e){e.unSave||this.$set(e,"optShow",!0)},mouseLeave(e){e.unSave||this.$set(e,"optShow",!1)},rename(e){this.$set(e,"unSave",!0)},save(e){if(e.id)this.$request.put("/diskFiles/update",e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}));else{let t="/diskFiles/add?folder=是&name="+e.name;this.folderId&&(t+="&folderId="+this.folderId),this.$request.post(t).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))}},cancel(e){let t=e.$index;e.id?this.load():this.tableData.splice(t,1)},addFolder(){this.tableData.unshift({name:"",type:"folder",unSave:!0,folderId:this.folderId||null})},load(){this.$request.get("/diskFiles/selectAll",{params:{category:this.category||null,folderId:this.folderId||null}}).then((e=>{this.tableData=e.data||[],this.tableData.forEach((e=>{this.$set(e,"optShow",!1)}))})),this.$request.get("/diskFiles/selectFolders",{params:{folderId:this.folderId||null}}).then((e=>{this.folders=e.data||[]}))},handleFileSuccess(e){"200"===e.code?(this.$message.success("上传成功"),this.load()):this.$message.error("上传失败")},del(e){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((t=>{this.$request.delete("/diskFiles/trash/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{}))},handleSelectionChange(e){this.ids=e.map((e=>e.id))},delBatch(){this.ids.length?this.$confirm("您确定批量删除这些数据吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/diskFiles/trash/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},copyLink(e){let t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t),this.$message.success("复制成功")}}}),n=r,c=s(3736),d=(0,c.Z)(n,a,l,!1,null,"4459f0fa",null),h=d.exports,p=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{padding:"15px","border-bottom":"1px solid #ddd"}},[t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.delBatch}},[e._v("批量删除")])],1),t("el-table",{attrs:{size:"medium",data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"文件名称"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticStyle:{display:"flex",cursor:"pointer"},on:{mouseenter:function(t){return e.mouseEnter(s.row)},mouseleave:function(t){return e.mouseLeave(s.row)}}},[t("div",{staticStyle:{flex:"1"}},[t("i",{class:e.typeList.find((e=>e.text===s.row.type))?.icon||"el-icon-file",staticStyle:{color:"#409EFF"}}),s.row.unSave?e._e():t("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(s.row.name))])]),s.row.optShow?t("div",{staticStyle:{color:"#409EFF","font-size":"14px"}},[t("el-tooltip",{attrs:{content:"删除",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-delete",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return e.del(s.row.fileId)}}})]),t("el-tooltip",{attrs:{content:"还原",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return e.restore(s.row.fileId)}}})])],1):e._e()])]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:"删除时间",width:"300"}}),t("el-table-column",{attrs:{prop:"size",label:"文件大小（KB）",width:"300"}})],1)],1)},u=[],m={name:"Trash",props:{typeList:null},data(){return{tableData:[]}},created(){this.load()},methods:{restore(e){this.$request.put("/diskFiles/restore/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))},del(e){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((t=>{this.$request.delete("/diskFiles/delete/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{}))},handleSelectionChange(e){this.ids=e.map((e=>e.fileId))},delBatch(){this.ids.length?this.$confirm("您确定批量删除这些数据吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/diskFiles/delete/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},load(){this.$request.get("/diskFiles/selectTrash").then((e=>{this.tableData=e.data||[]}))},mouseEnter(e){this.$set(e,"optShow",!0)},mouseLeave(e){this.$set(e,"optShow",!1)}}},f=m,g=(0,c.Z)(f,p,u,!1,null,"4464f224",null),y=g.exports,v=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{padding:"15px","border-bottom":"1px solid #ddd"}},[t("el-button",{attrs:{type:"danger",plain:"",disabled:!e.tableData.length||!e.ids.length},on:{click:e.delBatch}},[e._v("取消分享")])],1),t("el-table",{attrs:{size:"medium",data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"文件名称"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticStyle:{display:"flex",cursor:"pointer"},on:{mouseenter:function(t){return e.mouseEnter(s.row)},mouseleave:function(t){return e.mouseLeave(s.row)}}},[t("div",{staticStyle:{flex:"1"}},[t("i",{class:e.typeList.find((e=>e.text===s.row.type))?.icon||"el-icon-file",staticStyle:{color:"#409EFF"}}),s.row.unSave?e._e():t("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(s.row.name))])]),s.row.optShow?t("div",{staticStyle:{color:"#409EFF","font-size":"14px"}},[t("el-tooltip",{attrs:{content:"取消分享",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-remove-outline",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return e.del(s.row.id)}}})]),t("el-tooltip",{attrs:{content:"复制链接",effect:"light","open-delay":1e3}},[t("i",{staticClass:"el-icon-document-copy",staticStyle:{"margin-right":"10px",cursor:"pointer"},on:{click:function(t){return e.copy(s.row)}}})])],1):e._e()])]}}])}),t("el-table-column",{attrs:{prop:"shareTime",label:"分享时间",width:"200"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"200"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.status.includes("小时")?t("span",{staticStyle:{color:"red"}},[e._v(e._s(s.row.status))]):t("span",[e._v(e._s(s.row.status))])]}}])}),t("el-table-column",{attrs:{prop:"count",label:"访问次数",width:"200"}})],1)],1)},x=[],S={name:"ShareComponent",props:{typeList:null},data(){return{tableData:[],ids:[]}},created(){this.load()},methods:{copy(e){let t=location.href.substring(0,location.href.indexOf("/front")),s=t+"/front/openShare?code="+e.code+"&shareId="+e.id,i=document.createElement("input");i.value=s,document.body.appendChild(i),i.select(),document.execCommand("Copy"),document.body.removeChild(i),this.$message.success("复制成功")},del(e){this.$confirm("您确定取消分享吗？","确认取消分享",{type:"warning"}).then((t=>{this.$request.delete("/share/delete/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{}))},handleSelectionChange(e){this.ids=e.map((e=>e.id))},delBatch(){this.ids.length?this.$confirm("您确定批量取消分享吗？","确认取消分享",{type:"warning"}).then((e=>{this.$request.delete("/share/delete/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load()):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},load(){this.$request.get("/share/selectAll").then((e=>{this.tableData=e.data||[]}))},mouseEnter(e){this.$set(e,"optShow",!0)},mouseLeave(e){this.$set(e,"optShow",!1)}}},b=S,w=(0,c.Z)(b,v,x,!1,null,"1021552d",null),$=w.exports,k={components:{Share:$,Trash:y,Main:h},data(){return{categoryList:[{text:"全部文件",category:"all",icon:""},{text:"图片",category:"img",icon:"el-icon-picture-outline"},{text:"视频",category:"video",icon:"el-icon-video-play"},{text:"压缩",category:"zip",icon:"el-icon-box"}],typeList:[{text:"mp3",icon:"el-icon-mp3"},{text:"mp4",icon:"el-icon-mp4"},{text:"jpg",icon:"el-icon-jpg"},{text:"jpeg",icon:"el-icon-jpeg"},{text:"png",icon:"el-icon-png"},{text:"pdf",icon:"el-icon-pdf"},{text:"docx",icon:"el-icon-docx"},{text:"txt",icon:"el-icon-text"},{text:"zip",icon:"el-icon-zip"},{text:"folder",icon:"el-icon-folder"}],user:JSON.parse(localStorage.getItem("xm-user")||"{}"),category:this.$route.query.category}},mounted(){},methods:{loadFiles(e){location.href="/front/home?category="+e}}},_=k,F=(0,c.Z)(_,i,o,!1,null,"1b621770",null),C=F.exports}}]);
//# sourceMappingURL=205.8bfef515.js.map